<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="APP_MAUI_Apl_Dis_2025_II.Views.View_Ventas.Page_DetalleVenta"
             xmlns:components="clr-namespace:APP_MAUI_Apl_Dis_2025_II.Views.Components"
             xmlns:models="clr-namespace:WCF_Apl_Dis">

    <components:Background_Image>
        <ScrollView>
            <VerticalStackLayout Spacing="18"  Padding="16">

                <!-- CONTENEDOR PRINCIPAL -->
                <Border 
                BackgroundColor="#D9D9D9"
                Padding="15"
                StrokeShape="RoundRectangle 15"
                Stroke="#000000"
                StrokeThickness="1">

                    <VerticalStackLayout Spacing="15" Padding="10">

                        <Label 
                            x:Name="lblError" 
                            Text="" 
                            TextColor="Red" 
                            FontSize="14" 
                            HorizontalOptions="Center" 
                            IsVisible="False" />      
                        
                        <!-- Título -->
                        <Label Text="Detalle de Venta"
                            FontSize="24"
                            FontAttributes="Bold"
                            HorizontalOptions="Center"
                            TextColor="Black" />

                        <components:Input_Text
                            x:Name="Cliente"
                            Placeholder="Cliente"
                            IsEnabled="False"/>

                        <components:Input_Date
                            x:Name="InputFecha"
                            Placeholder="Fecha"
                            IsEnabled="False"/>

                        <components:Input_Text
                            x:Name="Estado"
                            Placeholder="Estado"
                            IsEnabled="False"/>

                        <components:Input_Float
                            x:Name="MontoTotal"
                            Placeholder="Costo Total"
                            IsEnabled="False"/>
                        
                        <components:Input_Float
                            x:Name="Pago"
                            Placeholder="Pago Realizado"
                            IsEnabled="False"/>
                        
                        <!-- Tabla de Detalle -->
                        <Border BackgroundColor="White" 
                         StrokeThickness="0" 
                         Padding="10" 
                         StrokeShape="RoundRectangle 12">

                            <VerticalStackLayout 
                            Spacing="10">

                                <!-- Encabezado -->
                                <Grid ColumnSpacing="10"
                                 RowDefinitions="45"
                                 ColumnDefinitions="*,1.2*,*,*">

                                    <Label Text="Plato"
                                     TextColor="Black"
                                     FontAttributes="Bold"
                                     VerticalOptions="Center"/>

                                    <Label Text="Precio"
                                     TextColor="Black"
                                     Grid.Column="1"
                                     FontAttributes="Bold"
                                     VerticalOptions="Center"/>

                                    <Label Text="Cantidad"
                                     TextColor="Black"
                                     Grid.Column="2"
                                     FontAttributes="Bold"
                                     VerticalOptions="Center"/>

                                    <Label Text="Descuento"
                                     TextColor="Black"
                                     Grid.Column="3"
                                     FontAttributes="Bold"
                                     VerticalOptions="Center"/>

                                </Grid>

                                <BoxView HeightRequest="1" Color="#E0E0E0"/>

                                <!-- CollectionView -->
                                <CollectionView 
                                    x:Name="TablaDetalle"
                                    SelectionMode="Single">

                                    <CollectionView.ItemTemplate>
                                        <DataTemplate>
                                            <Grid ColumnSpacing="10"
                                                RowDefinitions="45"
                                                ColumnDefinitions="*,1.2*,*,*"
                                                Padding="5"
                                                BackgroundColor="White">

                                                <Label 
                                                 Text="{Binding txt_Plato}"
                                                 TextColor="Black"/>

                                                <Label 
                                                    TextColor="Black"
                                                    Text="{Binding Precio_Unitario}"
                                                    Grid.Column="1" />

                                                <Label 
                                                    TextColor="Black"
                                                    Text="{Binding Cantidad}"
                                                    Grid.Column="2" />

                                                <Label 
                                                    TextColor="Black"
                                                    Text="{Binding Descuento}"
                                                    Grid.Column="3" />

                                            </Grid>
                                        </DataTemplate>
                                    </CollectionView.ItemTemplate>

                                </CollectionView>
                                <BoxView HeightRequest="1" Color="#E0E0E0"/>

                                <Grid ColumnSpacing="10"
                                    RowDefinitions="45"
                                    ColumnDefinitions="*,*">

                                    <Label 
                                        Grid.Column="0"
                                        Text="Monto:"
                                        TextColor="Black"
                                        FontAttributes="Bold"
                                        VerticalOptions="Start"/>

                                    <Label 
                                        Grid.Column="1"
                                        x:Name="Monto"
                                        Text="0"
                                        TextColor="Black"
                                        FontAttributes="Bold"
                                        VerticalOptions="Start"/>
                                </Grid>

                            </VerticalStackLayout>
                        </Border>

                        <!-- Botones de acción -->
                        <HorizontalStackLayout 
                            Spacing="20" 
                            HorizontalOptions="Center">

                            <Button 
                                x:Name="btn_Cancelar"
                                Text="Cancelar Venta"
                                BackgroundColor="Red"
                                TextColor="Black"
                                WidthRequest="150"
                                CornerRadius="10"
                                Clicked="Cancelar_Venta"/>
                        </HorizontalStackLayout>

                    </VerticalStackLayout>
                </Border>
            </VerticalStackLayout>
        </ScrollView>
    </components:Background_Image>
</ContentPage>